{% extends 'emails/base_email.html' %}

{% block content %}
<h2>ðŸ“Š Daily Incident Report</h2>

<p>Hello {{ recipient_name }},</p>

<p>Here is your daily HSE incident summary for <strong>{{ report_date }}</strong>.</p>

<!-- Summary Statistics -->
<div style="display: flex; flex-wrap: wrap; margin: 20px 0;">
    <div style="flex: 1; min-width: 120px; padding: 15px; margin: 5px; background-color: #e8eaf6; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold; color: #667eea;">{{ stats.total }}</div>
        <div style="color: #666; font-size: 12px; text-transform: uppercase;">New Incidents</div>
    </div>
    <div style="flex: 1; min-width: 120px; padding: 15px; margin: 5px; background-color: #ffebee; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold; color: #dc3545;">{{ stats.critical }}</div>
        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Critical</div>
    </div>
    <div style="flex: 1; min-width: 120px; padding: 15px; margin: 5px; background-color: #fff3e0; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold; color: #fd7e14;">{{ stats.high }}</div>
        <div style="color: #666; font-size: 12px; text-transform: uppercase;">High</div>
    </div>
    <div style="flex: 1; min-width: 120px; padding: 15px; margin: 5px; background-color: #fef9e7; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold; color: #f39c12;">{{ stats.overdue }}</div>
        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Overdue</div>
    </div>
</div>

<!-- Recent Incidents -->
{% if recent_incidents %}
<h3 style="color: #667eea; margin-top: 30px;">Recent Incidents</h3>
<table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
    <thead>
        <tr style="background-color: #f8f9fa;">
            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Reference</th>
            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Title</th>
            <th style="padding: 10px; text-align: center; border-bottom: 2px solid #dee2e6;">Severity</th>
        </tr>
    </thead>
    <tbody>
        {% for incident in recent_incidents %}
        <tr>
            <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">
                <a href="http://localhost:3000/incidents/{{ incident.id }}" style="color: #667eea; text-decoration: none;">
                    {{ incident.reference }}
                </a>
            </td>
            <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">{{ incident.title|truncatewords:8 }}</td>
            <td style="padding: 10px; border-bottom: 1px solid #dee2e6; text-align: center;">
                <span class="severity-badge severity-{{ incident.severity|lower }}">
                    {{ incident.get_severity_display }}
                </span>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}

<a href="http://localhost:3000/dashboard" class="button">
    View Full Dashboard
</a>

<p style="color: #6c757d; font-size: 14px; margin-top: 30px;">
    This report is generated automatically every day at 8:00 AM.
</p>
{% endblock %}